{"ast":null,"code":"import _objectSpread from\"/home/brian/Desktop/non-functional-wa-connection-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/brian/Desktop/non-functional-wa-connection-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useMemo,useState,useCallback}from\"react\";import{createEditor,Transforms,Editor,Text}from\"slate\";import{Slate,Editable,withReact}from\"slate-react\";import\"emoji-mart/css/emoji-mart.css\";import{Picker}from\"emoji-mart\";import{TextBold32,TextItalic32,TextStrikethrough32,Code32,FaceSatisfied32,TrashCan32}from\"@carbon/icons-react\";import{Button,Dropdown}from\"carbon-components-react\";import{connect}from\"react-redux\";import{CreateVariant,DeleteVariant,DeleteAll}from\"./../../store/actions/TextNessageVariantAction\";function reduceSlate(value){var lastIndex=value.length-1;var paragraphReducer=function paragraphReducer(accumulator,currentValue,index){var textReducer=function textReducer(accumulator,currentValue){if(currentValue.bold){if(currentValue.text!==\"\"){return\"\".concat(accumulator,\" *\").concat(currentValue.text,\"*\");}else{return\"\".concat(accumulator,\" \").concat(currentValue.text);}}else if(currentValue.italic){if(currentValue.text!==\"\"){return\"\".concat(accumulator,\" _\").concat(currentValue.text,\"_\");}else{return\"\".concat(accumulator,\" \").concat(currentValue.text);}}else if(currentValue.code){if(currentValue.text!==\"\"){return accumulator+\"```\"+currentValue.text+\"```\";}else{return\"\".concat(accumulator,\" \").concat(currentValue.text);}}else if(currentValue.overline){if(currentValue.text){return\"\".concat(accumulator,\" ~\").concat(currentValue.text,\"~\");}else{return\"\".concat(accumulator,\" \").concat(currentValue.text);}}else{return\"\".concat(accumulator,\" \").concat(currentValue.text);}};if(index!==lastIndex){return accumulator+\"\".concat(currentValue.children.reduce(textReducer,\"\"),\" \\n\");}else{return accumulator+\"\".concat(currentValue.children.reduce(textReducer,\"\"));}};return value.reduce(paragraphReducer,\"\");}function TextEditor(props){var editor=useMemo(function(){return withReact(createEditor());},[]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),emoji=_useState2[0],setEmoji=_useState2[1];var toggleEmoji=function toggleEmoji(){setEmoji(!emoji);};var DefaultElement=function DefaultElement(props){return/*#__PURE__*/_jsx(\"p\",_objectSpread(_objectSpread({},props.attributes),{},{children:props.children}));};var renderElement=useCallback(function(props){switch(props.element.type){default:return/*#__PURE__*/_jsx(DefaultElement,_objectSpread({},props));}},[]);var Leaf=function Leaf(_ref){var attributes=_ref.attributes,children=_ref.children,leaf=_ref.leaf;if(leaf.bold){children=/*#__PURE__*/_jsx(\"strong\",{children:children});}if(leaf.code){children=/*#__PURE__*/_jsx(\"code\",{children:children});}if(leaf.italic){children=/*#__PURE__*/_jsx(\"em\",{children:children});}if(leaf.overline){children=/*#__PURE__*/_jsx(\"strike\",{children:children});}return/*#__PURE__*/_jsx(\"span\",_objectSpread(_objectSpread({},attributes),{},{children:children}));};var addText=function addText(text){Transforms.insertText(editor,text);};var renderLeaf=useCallback(function(props){return/*#__PURE__*/_jsx(Leaf,_objectSpread({},props));},[]);var ToolBar=function ToolBar(){return/*#__PURE__*/_jsxs(\"div\",{className:\"ToolBar\",children:[/*#__PURE__*/_jsx(Dropdown,{onChange:function onChange(e){return addText(\"{\".concat(e.selectedItem,\"}\"));},size:\"sm\",type:\"inline\",items:props.variables,titleText:\"Variables\"}),/*#__PURE__*/_jsx(Button,{renderIcon:TextBold32,kind:\"ghost\",hasIconOnly:true,size:\"small\",iconDescription:\"Bold\",onClick:function onClick(){var _Editor$nodes=Editor.nodes(editor,{match:function match(n){return n.bold;}}),_Editor$nodes2=_slicedToArray(_Editor$nodes,1),match=_Editor$nodes2[0];Transforms.setNodes(editor,{bold:match?false:true},{match:function match(n){return Text.isText(n);},split:true});}}),/*#__PURE__*/_jsx(Button,{renderIcon:TextItalic32,kind:\"ghost\",hasIconOnly:true,iconDescription:\"Italic\",size:\"small\",onClick:function onClick(){var _Editor$nodes3=Editor.nodes(editor,{match:function match(n){return n.italic;}}),_Editor$nodes4=_slicedToArray(_Editor$nodes3,1),match=_Editor$nodes4[0];Transforms.setNodes(editor,{italic:match?false:true},{match:function match(n){return Text.isText(n);},split:true});}}),/*#__PURE__*/_jsx(Button,{renderIcon:TextStrikethrough32,kind:\"ghost\",hasIconOnly:true,iconDescription:\"Strike through\",size:\"small\",onClick:function onClick(){var _Editor$nodes5=Editor.nodes(editor,{match:function match(n){return n.overline;}}),_Editor$nodes6=_slicedToArray(_Editor$nodes5,1),match=_Editor$nodes6[0];Transforms.setNodes(editor,{overline:match?false:true},{match:function match(n){return Text.isText(n);},split:true});}}),/*#__PURE__*/_jsx(Button,{renderIcon:Code32,kind:\"ghost\",hasIconOnly:true,iconDescription:\"Monospace\",size:\"small\",onClick:function onClick(){var _Editor$nodes7=Editor.nodes(editor,{match:function match(n){return n.code;}}),_Editor$nodes8=_slicedToArray(_Editor$nodes7,1),match=_Editor$nodes8[0];Transforms.setNodes(editor,{code:match?false:true},{match:function match(n){return Text.isText(n);},split:true});}}),/*#__PURE__*/_jsx(Button,{renderIcon:FaceSatisfied32,kind:\"ghost\",iconDescription:\"Emoji\",hasIconOnly:true,size:\"small\",onClick:toggleEmoji})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"TextEditor\",children:[props.open?/*#__PURE__*/_jsx(ToolBar,{}):null,/*#__PURE__*/_jsx(\"div\",{className:\"EmojiPicker\",children:emoji?/*#__PURE__*/_jsx(Picker,{title:\"Connectivity's\",perLine:8,showPreview:false,onClick:function onClick(emoji){addText(emoji.native);}}):null}),/*#__PURE__*/_jsxs(\"div\",{className:\"Main\",children:[/*#__PURE__*/_jsx(Slate,{editor:editor,value:props.textState,onChange:function onChange(newValue){props.editVariant(props.editorIndex,{body:reduceSlate(newValue),textState:newValue});},children:/*#__PURE__*/_jsx(Editable,{renderElement:renderElement,renderLeaf:renderLeaf})}),props.open?null:/*#__PURE__*/_jsx(Button,{className:\"DeleteButton\",hasIconOnly:true,renderIcon:TrashCan32,onClick:function onClick(){console.log(props.editorIndex);props.deleteVariant(props.editorIndex);},kind:\"secondary\",iconDescription:\"Delete this variant\"})]})]});}var stateToProps=function stateToProps(state){return{textMessageVariants:state.textMessageVariants,contacts:state.firestore.ordered.contacts,connections:state.firestore.ordered.connections,uid:state.firebase.auth.uid};};var dispatchToProps=function dispatchToProps(dispatch){return{createVariant:function createVariant(elm){return dispatch(CreateVariant(elm));},deleteVariant:function deleteVariant(elm){return dispatch(DeleteVariant(elm));},deleteAll:function deleteAll(){return dispatch(DeleteAll());}};};export default connect(stateToProps,dispatchToProps)(TextEditor);","map":{"version":3,"sources":["/home/brian/Desktop/non-functional-wa-connection-demo/src/components/TextEditor/TextEditor.js"],"names":["React","useMemo","useState","useCallback","createEditor","Transforms","Editor","Text","Slate","Editable","withReact","Picker","TextBold32","TextItalic32","TextStrikethrough32","Code32","FaceSatisfied32","TrashCan32","Button","Dropdown","connect","CreateVariant","DeleteVariant","DeleteAll","reduceSlate","value","lastIndex","length","paragraphReducer","accumulator","currentValue","index","textReducer","bold","text","italic","code","overline","children","reduce","TextEditor","props","editor","emoji","setEmoji","toggleEmoji","DefaultElement","attributes","renderElement","element","type","Leaf","leaf","addText","insertText","renderLeaf","ToolBar","e","selectedItem","variables","nodes","match","n","setNodes","isText","split","open","native","textState","newValue","editVariant","editorIndex","body","console","log","deleteVariant","stateToProps","state","textMessageVariants","contacts","firestore","ordered","connections","uid","firebase","auth","dispatchToProps","dispatch","createVariant","elm","deleteAll"],"mappings":"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","sourcesContent":["import React, { useMemo, useState, useCallback } from \"react\";\nimport { createEditor, Transforms, Editor, Text } from \"slate\";\nimport { Slate, Editable, withReact } from \"slate-react\";\nimport \"emoji-mart/css/emoji-mart.css\";\nimport { Picker } from \"emoji-mart\";\nimport {\n  TextBold32,\n  TextItalic32,\n  TextStrikethrough32,\n  Code32,\n  FaceSatisfied32,\n  TrashCan32,\n} from \"@carbon/icons-react\";\nimport { Button, Dropdown } from \"carbon-components-react\";\nimport { connect } from \"react-redux\";\nimport {\n  CreateVariant,\n  DeleteVariant,\n  DeleteAll,\n} from \"./../../store/actions/TextNessageVariantAction\";\n\nfunction reduceSlate(value) {\n  const lastIndex = value.length - 1;\n  const paragraphReducer = (accumulator, currentValue, index) => {\n    const textReducer = (accumulator, currentValue) => {\n      if (currentValue.bold) {\n        if (currentValue.text !== \"\") {\n          return `${accumulator} *${currentValue.text}*`;\n        } else {\n          return `${accumulator} ${currentValue.text}`;\n        }\n      } else if (currentValue.italic) {\n        if (currentValue.text !== \"\") {\n          return `${accumulator} _${currentValue.text}_`;\n        } else {\n          return `${accumulator} ${currentValue.text}`;\n        }\n      } else if (currentValue.code) {\n        if (currentValue.text !== \"\") {\n          return accumulator + \"```\" + currentValue.text + \"```\";\n        } else {\n          return `${accumulator} ${currentValue.text}`;\n        }\n      } else if (currentValue.overline) {\n        if (currentValue.text) {\n          return `${accumulator} ~${currentValue.text}~`;\n        } else {\n          return `${accumulator} ${currentValue.text}`;\n        }\n      } else {\n        return `${accumulator} ${currentValue.text}`;\n      }\n    };\n\n    if (index !== lastIndex) {\n      return (\n        accumulator + `${currentValue.children.reduce(textReducer, \"\")} \\n`\n      );\n    } else {\n      return accumulator + `${currentValue.children.reduce(textReducer, \"\")}`;\n    }\n  };\n  return value.reduce(paragraphReducer, \"\");\n}\n\nfunction TextEditor(props) {\n  const editor = useMemo(() => withReact(createEditor()), []);\n  const [emoji, setEmoji] = useState(false);\n\n  const toggleEmoji = () => {\n    setEmoji(!emoji);\n  };\n\n  const DefaultElement = (props) => {\n    return <p {...props.attributes}>{props.children}</p>;\n  };\n\n  const renderElement = useCallback((props) => {\n    switch (props.element.type) {\n      default:\n        return <DefaultElement {...props} />;\n    }\n  }, []);\n\n  const Leaf = ({ attributes, children, leaf }) => {\n    if (leaf.bold) {\n      children = <strong>{children}</strong>;\n    }\n\n    if (leaf.code) {\n      children = <code>{children}</code>;\n    }\n\n    if (leaf.italic) {\n      children = <em>{children}</em>;\n    }\n\n    if (leaf.overline) {\n      children = <strike>{children}</strike>;\n    }\n\n    return <span {...attributes}>{children}</span>;\n  };\n\n  const addText = (text) => {\n    Transforms.insertText(editor, text);\n  };\n\n  const renderLeaf = useCallback((props) => {\n    return <Leaf {...props} />;\n  }, []);\n\n  const ToolBar = () => {\n    return (\n      <div className=\"ToolBar\">\n        <Dropdown\n          onChange={(e) => addText(`{${e.selectedItem}}`)}\n          size=\"sm\"\n          type=\"inline\"\n          items={props.variables}\n          titleText=\"Variables\"\n        />\n        <Button\n          renderIcon={TextBold32}\n          kind=\"ghost\"\n          hasIconOnly\n          size={\"small\"}\n          iconDescription=\"Bold\"\n          onClick={() => {\n            const [match] = Editor.nodes(editor, {\n              match: (n) => n.bold,\n            });\n\n            Transforms.setNodes(\n              editor,\n              { bold: match ? false : true },\n              { match: (n) => Text.isText(n), split: true }\n            );\n          }}\n        />\n        <Button\n          renderIcon={TextItalic32}\n          kind=\"ghost\"\n          hasIconOnly\n          iconDescription=\"Italic\"\n          size={\"small\"}\n          onClick={() => {\n            const [match] = Editor.nodes(editor, {\n              match: (n) => n.italic,\n            });\n\n            Transforms.setNodes(\n              editor,\n              { italic: match ? false : true },\n              { match: (n) => Text.isText(n), split: true }\n            );\n          }}\n        />\n        <Button\n          renderIcon={TextStrikethrough32}\n          kind=\"ghost\"\n          hasIconOnly\n          iconDescription=\"Strike through\"\n          size={\"small\"}\n          onClick={() => {\n            const [match] = Editor.nodes(editor, {\n              match: (n) => n.overline,\n            });\n\n            Transforms.setNodes(\n              editor,\n              { overline: match ? false : true },\n              { match: (n) => Text.isText(n), split: true }\n            );\n          }}\n        />\n        <Button\n          renderIcon={Code32}\n          kind=\"ghost\"\n          hasIconOnly\n          iconDescription=\"Monospace\"\n          size={\"small\"}\n          onClick={() => {\n            const [match] = Editor.nodes(editor, {\n              match: (n) => n.code,\n            });\n\n            Transforms.setNodes(\n              editor,\n              { code: match ? false : true },\n              { match: (n) => Text.isText(n), split: true }\n            );\n          }}\n        />\n        {/*\n        <button\n          onClick={() => {\n            console.log(reduceSlate(value));\n          }}\n        >\n          Reduce\n        </button>\n\n\n        <select onChange={(e) => addText(e.target.value)}>\n          <option value=\"{opt1}\">Opt1</option>\n          <option value=\"{opt2}\">Opt2</option>\n          <option value=\"{opt3}\">Opt3</option>\n        </select>\n\t*/}\n        <Button\n          renderIcon={FaceSatisfied32}\n          kind=\"ghost\"\n          iconDescription=\"Emoji\"\n          hasIconOnly\n          size={\"small\"}\n          onClick={toggleEmoji}\n        />\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"TextEditor\">\n      {props.open ? <ToolBar /> : null}\n      <div className=\"EmojiPicker\">\n        {emoji ? (\n          <Picker\n            title=\"Connectivity's\"\n            perLine={8}\n            showPreview={false}\n            onClick={(emoji) => {\n              addText(emoji.native);\n            }}\n          />\n        ) : null}\n      </div>\n\n      <div className=\"Main\">\n        <Slate\n          editor={editor}\n          value={props.textState}\n          onChange={(newValue) => {\n            props.editVariant(props.editorIndex, {\n              body: reduceSlate(newValue),\n              textState: newValue,\n            });\n          }}\n        >\n          <Editable renderElement={renderElement} renderLeaf={renderLeaf} />\n        </Slate>\n        {props.open ? null : (\n          <Button\n            className=\"DeleteButton\"\n            hasIconOnly\n            renderIcon={TrashCan32}\n            onClick={() => {\n              console.log(props.editorIndex);\n              props.deleteVariant(props.editorIndex);\n            }}\n            kind={\"secondary\"}\n            iconDescription=\"Delete this variant\"\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst stateToProps = (state) => {\n  return {\n    textMessageVariants: state.textMessageVariants,\n    contacts: state.firestore.ordered.contacts,\n    connections: state.firestore.ordered.connections,\n    uid: state.firebase.auth.uid,\n  };\n};\n\nconst dispatchToProps = (dispatch) => {\n  return {\n    createVariant: (elm) => dispatch(CreateVariant(elm)),\n    deleteVariant: (elm) => dispatch(DeleteVariant(elm)),\n    deleteAll: () => dispatch(DeleteAll()),\n  };\n};\n\nexport default connect(stateToProps, dispatchToProps)(TextEditor);\n"]},"metadata":{},"sourceType":"module"}