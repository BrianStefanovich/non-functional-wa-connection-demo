{"ast":null,"code":"import _regeneratorRuntime from\"/home/brian/Desktop/non-functional-wa-connection-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/brian/Desktop/non-functional-wa-connection-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/brian/Desktop/non-functional-wa-connection-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState}from\"react\";import{TrashCan16}from\"@carbon/icons-react\";import{FileUploaderItem,FileUploaderDropContainer,Loading,Button,InlineNotification}from\"carbon-components-react\";import AudioPlayer from\"react-h5-audio-player\";import\"react-h5-audio-player/lib/styles.css\";import{DefaultPlayer as Video}from\"react-html5video\";import\"react-html5video/dist/styles.css\";import{useFirebase}from\"react-redux-firebase\";import{connect}from\"react-redux\";import{CreateVariant,DeleteVariant,DeleteAll,SetActiveVariant,SetMediaPath,SetMediaType}from\"./../../store/actions/MediaMessageVariantAction\";function MediaGadget(props){var firebase=useFirebase();var _useState=useState(\"upload\"),_useState2=_slicedToArray(_useState,2),status=_useState2[0],setStatus=_useState2[1];var _useState3=useState(\"#\"),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];var _useState5=useState(\"#\"),_useState6=_slicedToArray(_useState5,2),audio=_useState6[0],setAudio=_useState6[1];var _useState7=useState(\"#\"),_useState8=_slicedToArray(_useState7,2),video=_useState8[0],setVideo=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),document=_useState10[0],setDocument=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),fileName=_useState12[0],setFileName=_useState12[1];var _useState13=useState({isOn:false,message:\"\"}),_useState14=_slicedToArray(_useState13,2),warn=_useState14[0],setWarn=_useState14[1];var handleFile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(evt,_ref){var addedFiles,file,MBSize,correctFormat,upload;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:addedFiles=_ref.addedFiles;file=addedFiles[0];MBSize=file.size*0.000001;correctFormat=file.type===\"application/pdf\"||file.type===\"image/jpg\"||file.type===\"audio/mpeg\"||file.type===\"video/mp4\"||file.type===\"image/jpeg\";if(MBSize>2.5){setWarn({isOn:true,message:\"File size must be less than 2.5mb\"});}else if(!correctFormat){setWarn({isOn:true,message:\"Incorrect file format. \".concat(file.type,\" not allowed\")});}else{setWarn({isOn:false,message:\"\"});}upload=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return firebase.uploadFile(\"user/\".concat(props.uid,\"/media\"),file);case 2:case\"end\":return _context.stop();}}},_callee);}));return function upload(){return _ref3.apply(this,arguments);};}();setFileName(file.name);setStatus(\"loading\");_context2.t0=file.type;_context2.next=_context2.t0===\"application/pdf\"?11:_context2.t0===\"image/jpeg\"?27:_context2.t0===\"image/jpg\"?43:_context2.t0===\"audio/mpeg\"?58:_context2.t0===\"video/mp4\"?74:90;break;case 11:if(!(MBSize>2.5||!correctFormat)){_context2.next=18;break;}setStatus(\"upload\");props.setAddText(false);props.setSendMessage(false);return _context2.abrupt(\"break\",94);case 18:props.setMediaPath(file.name);_context2.next=21;return upload();case 21:setDocument(file.name);props.setMediaType(\"document\");props.setSendMessage(true);props.setAddText(false);setStatus(\"document\");return _context2.abrupt(\"break\",94);case 27:if(!(MBSize>2.5||!correctFormat)){_context2.next=34;break;}setStatus(\"upload\");props.setAddText(false);props.setSendMessage(false);return _context2.abrupt(\"break\",94);case 34:props.setMediaPath(file.name);_context2.next=37;return upload();case 37:setImage(URL.createObjectURL(file));props.setMediaType(\"image\");props.setAddText(true);props.setSendMessage(true);setStatus(\"image\");return _context2.abrupt(\"break\",94);case 43:if(!(MBSize>2.5||!correctFormat)){_context2.next=50;break;}setStatus(\"upload\");props.setAddText(false);props.setSendMessage(false);return _context2.abrupt(\"break\",94);case 50:props.setMediaPath(file.name);_context2.next=53;return upload();case 53:setImage(URL.createObjectURL(file));props.setMediaType(\"image\");props.setSendMessage(true);setStatus(\"image\");return _context2.abrupt(\"break\",94);case 58:if(!(MBSize>2.5||!correctFormat)){_context2.next=65;break;}setStatus(\"upload\");props.setAddText(false);props.setSendMessage(false);return _context2.abrupt(\"break\",94);case 65:props.setMediaPath(file.name);_context2.next=68;return upload();case 68:setAudio(URL.createObjectURL(file));props.setMediaType(\"audio\");props.setAddText(false);props.setSendMessage(true);setStatus(\"audio\");return _context2.abrupt(\"break\",94);case 74:if(!(MBSize>2.5||!correctFormat)){_context2.next=81;break;}setStatus(\"upload\");props.setAddText(false);props.setSendMessage(false);return _context2.abrupt(\"break\",94);case 81:props.setMediaPath(file.name);_context2.next=84;return upload();case 84:setVideo(URL.createObjectURL(file));props.setMediaType(\"video\");props.setAddText(true);props.setSendMessage(true);setStatus(\"video\");return _context2.abrupt(\"break\",94);case 90:setStatus(\"upload\");props.setAddText(false);props.setSendMessage(false);return _context2.abrupt(\"break\",94);case 94:case\"end\":return _context2.stop();}}},_callee2);}));return function handleFile(_x,_x2){return _ref2.apply(this,arguments);};}();var deleteVideo=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var ref;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:ref=firebase.storage().ref(\"user/\".concat(props.uid,\"/media/\").concat(fileName));_context3.next=3;return ref.delete();case 3:props.setSendMessage(false);props.setMediaPath(\"\");props.deleteAll();setStatus(\"upload\");case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function deleteVideo(){return _ref4.apply(this,arguments);};}();var deleteAudio=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var ref;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:ref=firebase.storage().ref(\"user/\".concat(props.uid,\"/media/\").concat(fileName));_context4.next=3;return ref.delete();case 3:props.setSendMessage(false);props.setMediaPath(\"\");props.deleteAll();setStatus(\"upload\");case 7:case\"end\":return _context4.stop();}}},_callee4);}));return function deleteAudio(){return _ref5.apply(this,arguments);};}();var deleteImage=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var ref;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:ref=firebase.storage().ref(\"user/\".concat(props.uid,\"/media/\").concat(fileName));_context5.next=3;return ref.delete();case 3:props.setSendMessage(false);props.setMediaPath(\"\");props.deleteAll();setStatus(\"upload\");case 7:case\"end\":return _context5.stop();}}},_callee5);}));return function deleteImage(){return _ref6.apply(this,arguments);};}();var deleteDocument=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var ref;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:ref=firebase.storage().ref(\"user/\".concat(props.uid,\"/media/\").concat(fileName));_context6.next=3;return ref.delete();case 3:props.setSendMessage(false);props.setMediaPath(\"\");props.deleteAll();setStatus(\"upload\");case 7:case\"end\":return _context6.stop();}}},_callee6);}));return function deleteDocument(){return _ref7.apply(this,arguments);};}();if(status===\"image\"){return/*#__PURE__*/_jsxs(\"div\",{className:\"MediaGadget\",children:[/*#__PURE__*/_jsx(\"img\",{alt:\"\",className:\"image\",src:image}),/*#__PURE__*/_jsx(\"div\",{className:\"DeleteButton\",children:/*#__PURE__*/_jsx(Button,{iconDescription:\"Delete this file\",hasIconOnly:true,renderIcon:TrashCan16,kind:\"secondary\",size:\"sm\",onClick:deleteImage})})]});}else if(status===\"document\"){return/*#__PURE__*/_jsx(\"div\",{className:\"MediaGadget\",children:/*#__PURE__*/_jsx(FileUploaderItem,{name:document,status:\"edit\",onDelete:deleteDocument})});}else if(status===\"video\"){return/*#__PURE__*/_jsxs(\"div\",{className:\"MediaGadget\",children:[/*#__PURE__*/_jsx(Video,{loop:true,controls:[\"PlayPause\",\"Seek\",\"Time\",\"Volume\"],children:/*#__PURE__*/_jsx(\"source\",{src:video,type:\"video/mp4\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"DeleteButton\",children:/*#__PURE__*/_jsx(Button,{iconDescription:\"Delete this file\",hasIconOnly:true,renderIcon:TrashCan16,kind:\"secondary\",size:\"sm\",onClick:deleteVideo})})]});}else if(status===\"audio\"){return/*#__PURE__*/_jsxs(\"div\",{className:\"MediaGadget\",children:[/*#__PURE__*/_jsx(AudioPlayer,{src:audio}),/*#__PURE__*/_jsx(\"div\",{className:\"DeleteButton\",children:/*#__PURE__*/_jsx(Button,{iconDescription:\"Delete this file\",hasIconOnly:true,renderIcon:TrashCan16,kind:\"secondary\",size:\"sm\",onClick:deleteAudio})})]});}else if(status===\"loading\"){return/*#__PURE__*/_jsx(\"div\",{className:\"MediaGadget\",children:/*#__PURE__*/_jsx(Loading,{withOverlay:false})});}else if(status===\"upload\"){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"MediaGadget\",children:/*#__PURE__*/_jsx(FileUploaderDropContainer,{labelText:\"Drop your media file here\",onAddFiles:handleFile,accept:[\"application/pdf\",\"image/png\",\"image/jpg\",\"image/jpeg\",\"audio/mpeg\",\"video/mp4\"]})}),warn.isOn?/*#__PURE__*/_jsx(\"div\",{className:\"Warn\",children:/*#__PURE__*/_jsx(InlineNotification,{kind:\"warning\",title:warn.message})}):null]});}else{return/*#__PURE__*/_jsx(\"div\",{className:\"MediaGadget\",children:/*#__PURE__*/_jsx(FileUploaderDropContainer,{labelText:\"Drop your media file here\"})});}}var stateToProps=function stateToProps(state){return{uid:state.firebase.auth.uid};};var dispatchToProps=function dispatchToProps(dispatch){return{createVariant:function createVariant(elm){return dispatch(CreateVariant(elm));},deleteVariant:function deleteVariant(id){return dispatch(DeleteVariant(id));},deleteAll:function deleteAll(){return dispatch(DeleteAll());},setActiveVariant:function setActiveVariant(id){return dispatch(SetActiveVariant(id));},setMediaPath:function setMediaPath(path){return dispatch(SetMediaPath(path));},setMediaType:function setMediaType(type){return dispatch(SetMediaType(type));}};};export default connect(stateToProps,dispatchToProps)(MediaGadget);","map":{"version":3,"sources":["/home/brian/Desktop/non-functional-wa-connection-demo/src/components/MediaGadget/MediaGadget.js"],"names":["React","useState","TrashCan16","FileUploaderItem","FileUploaderDropContainer","Loading","Button","InlineNotification","AudioPlayer","DefaultPlayer","Video","useFirebase","connect","CreateVariant","DeleteVariant","DeleteAll","SetActiveVariant","SetMediaPath","SetMediaType","MediaGadget","props","firebase","status","setStatus","image","setImage","audio","setAudio","video","setVideo","document","setDocument","fileName","setFileName","isOn","message","warn","setWarn","handleFile","evt","addedFiles","file","MBSize","size","correctFormat","type","upload","uploadFile","uid","name","setAddText","setSendMessage","setMediaPath","setMediaType","URL","createObjectURL","deleteVideo","ref","storage","delete","deleteAll","deleteAudio","deleteImage","deleteDocument","stateToProps","state","auth","dispatchToProps","dispatch","createVariant","elm","deleteVariant","id","setActiveVariant","path"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { TrashCan16 } from \"@carbon/icons-react\";\nimport {\n  FileUploaderItem,\n  FileUploaderDropContainer,\n  Loading,\n  Button,\n  InlineNotification,\n} from \"carbon-components-react\";\nimport AudioPlayer from \"react-h5-audio-player\";\nimport \"react-h5-audio-player/lib/styles.css\";\nimport { DefaultPlayer as Video } from \"react-html5video\";\nimport \"react-html5video/dist/styles.css\";\nimport { useFirebase } from \"react-redux-firebase\";\nimport { connect } from \"react-redux\";\nimport {\n  CreateVariant,\n  DeleteVariant,\n  DeleteAll,\n  SetActiveVariant,\n  SetMediaPath,\n  SetMediaType,\n} from \"./../../store/actions/MediaMessageVariantAction\";\n\nfunction MediaGadget(props) {\n  const firebase = useFirebase();\n  const [status, setStatus] = useState(\"upload\");\n  const [image, setImage] = useState(\"#\");\n  const [audio, setAudio] = useState(\"#\");\n  const [video, setVideo] = useState(\"#\");\n  const [document, setDocument] = useState({});\n  const [fileName, setFileName] = useState(\"\");\n  const [warn, setWarn] = useState({\n    isOn: false,\n    message: \"\",\n  });\n\n  const handleFile = async (evt, { addedFiles }) => {\n    const file = addedFiles[0];\n    const MBSize = file.size * 0.000001;\n    const correctFormat =\n      file.type === \"application/pdf\" ||\n      file.type === \"image/jpg\" ||\n      file.type === \"audio/mpeg\" ||\n      file.type === \"video/mp4\" ||\n      file.type === \"image/jpeg\";\n\n    if (MBSize > 2.5) {\n      setWarn({\n        isOn: true,\n        message: \"File size must be less than 2.5mb\",\n      });\n    } else if (!correctFormat) {\n      setWarn({\n        isOn: true,\n        message: `Incorrect file format. ${file.type} not allowed`,\n      });\n    } else {\n      setWarn({\n        isOn: false,\n        message: \"\",\n      });\n    }\n\n    const upload = async () => {\n      await firebase.uploadFile(`user/${props.uid}/media`, file);\n    };\n\n    setFileName(file.name);\n    setStatus(\"loading\");\n\n    switch (file.type) {\n      case \"application/pdf\":\n        if (MBSize > 2.5 || !correctFormat) {\n          setStatus(\"upload\");\n          props.setAddText(false);\n          props.setSendMessage(false);\n          break;\n        } else {\n          props.setMediaPath(file.name);\n          await upload();\n          setDocument(file.name);\n          props.setMediaType(\"document\");\n          props.setSendMessage(true);\n          props.setAddText(false);\n          setStatus(\"document\");\n          break;\n        }\n\n      /*\n      case \"image/png\":\n        props.setMediaPath(file.name);\n        await firebase.uploadFile(`user/${props.uid}/media`, file);\n        await createSticker();\n        setImage(URL.createObjectURL(file));\n        props.setMediaType(\"sticker\");\n        props.setAddText(false);\n        props.setSendMessage(true);\n        setStatus(\"sticker\");\n        break;\n*/\n      case \"image/jpeg\":\n        if (MBSize > 2.5 || !correctFormat) {\n          setStatus(\"upload\");\n          props.setAddText(false);\n          props.setSendMessage(false);\n          break;\n        } else {\n          props.setMediaPath(file.name);\n          await upload();\n          setImage(URL.createObjectURL(file));\n          props.setMediaType(\"image\");\n          props.setAddText(true);\n          props.setSendMessage(true);\n          setStatus(\"image\");\n          break;\n        }\n\n      case \"image/jpg\":\n        if (MBSize > 2.5 || !correctFormat) {\n          setStatus(\"upload\");\n          props.setAddText(false);\n          props.setSendMessage(false);\n          break;\n        } else {\n          props.setMediaPath(file.name);\n          await upload();\n          setImage(URL.createObjectURL(file));\n          props.setMediaType(\"image\");\n          props.setSendMessage(true);\n          setStatus(\"image\");\n          break;\n        }\n\n      case \"audio/mpeg\":\n        if (MBSize > 2.5 || !correctFormat) {\n          setStatus(\"upload\");\n          props.setAddText(false);\n          props.setSendMessage(false);\n          break;\n        } else {\n          props.setMediaPath(file.name);\n          await upload();\n          setAudio(URL.createObjectURL(file));\n          props.setMediaType(\"audio\");\n          props.setAddText(false);\n          props.setSendMessage(true);\n          setStatus(\"audio\");\n          break;\n        }\n\n      case \"video/mp4\":\n        if (MBSize > 2.5 || !correctFormat) {\n          setStatus(\"upload\");\n          props.setAddText(false);\n          props.setSendMessage(false);\n          break;\n        } else {\n          props.setMediaPath(file.name);\n          await upload();\n          setVideo(URL.createObjectURL(file));\n          props.setMediaType(\"video\");\n          props.setAddText(true);\n          props.setSendMessage(true);\n          setStatus(\"video\");\n          break;\n        }\n\n      default:\n        setStatus(\"upload\");\n        props.setAddText(false);\n        props.setSendMessage(false);\n        break;\n    }\n  };\n\n  const deleteVideo = async () => {\n    const ref = firebase.storage().ref(`user/${props.uid}/media/${fileName}`);\n    await ref.delete();\n    props.setSendMessage(false);\n    props.setMediaPath(\"\");\n    props.deleteAll();\n    setStatus(\"upload\");\n  };\n\n  const deleteAudio = async () => {\n    const ref = firebase.storage().ref(`user/${props.uid}/media/${fileName}`);\n    await ref.delete();\n    props.setSendMessage(false);\n    props.setMediaPath(\"\");\n    props.deleteAll();\n    setStatus(\"upload\");\n  };\n\n  const deleteImage = async () => {\n    const ref = firebase.storage().ref(`user/${props.uid}/media/${fileName}`);\n    await ref.delete();\n    props.setSendMessage(false);\n    props.setMediaPath(\"\");\n    props.deleteAll();\n    setStatus(\"upload\");\n  };\n\n  const deleteDocument = async () => {\n    const ref = firebase.storage().ref(`user/${props.uid}/media/${fileName}`);\n    await ref.delete();\n    props.setSendMessage(false);\n    props.setMediaPath(\"\");\n    props.deleteAll();\n    setStatus(\"upload\");\n  };\n\n  if (status === \"image\") {\n    return (\n      <div className=\"MediaGadget\">\n        <img alt=\"\" className=\"image\" src={image} />\n        <div className=\"DeleteButton\">\n          <Button\n            iconDescription=\"Delete this file\"\n            hasIconOnly\n            renderIcon={TrashCan16}\n            kind=\"secondary\"\n            size=\"sm\"\n            onClick={deleteImage}\n          />\n        </div>\n      </div>\n    );\n  } else if (status === \"document\") {\n    return (\n      <div className=\"MediaGadget\">\n        <FileUploaderItem\n          name={document}\n          status=\"edit\"\n          onDelete={deleteDocument}\n        />\n      </div>\n    );\n  } else if (status === \"video\") {\n    return (\n      <div className=\"MediaGadget\">\n        <Video loop controls={[\"PlayPause\", \"Seek\", \"Time\", \"Volume\"]}>\n          <source src={video} type=\"video/mp4\" />\n        </Video>\n        <div className=\"DeleteButton\">\n          <Button\n            iconDescription=\"Delete this file\"\n            hasIconOnly\n            renderIcon={TrashCan16}\n            kind=\"secondary\"\n            size=\"sm\"\n            onClick={deleteVideo}\n          />\n        </div>\n      </div>\n    );\n  } else if (status === \"audio\") {\n    return (\n      <div className=\"MediaGadget\">\n        <AudioPlayer src={audio} />\n        <div className=\"DeleteButton\">\n          <Button\n            iconDescription=\"Delete this file\"\n            hasIconOnly\n            renderIcon={TrashCan16}\n            kind=\"secondary\"\n            size=\"sm\"\n            onClick={deleteAudio}\n          />\n        </div>\n      </div>\n    );\n  } else if (status === \"loading\") {\n    return (\n      <div className=\"MediaGadget\">\n        <Loading withOverlay={false} />\n      </div>\n    );\n  } else if (status === \"upload\") {\n    return (\n      <div>\n        <div className=\"MediaGadget\">\n          <FileUploaderDropContainer\n            labelText=\"Drop your media file here\"\n            onAddFiles={handleFile}\n            accept={[\n              \"application/pdf\",\n              \"image/png\",\n              \"image/jpg\",\n              \"image/jpeg\",\n              \"audio/mpeg\",\n              \"video/mp4\",\n            ]}\n          />\n        </div>\n        {warn.isOn ? (\n          <div className=\"Warn\">\n            <InlineNotification kind=\"warning\" title={warn.message} />\n          </div>\n        ) : null}\n      </div>\n    );\n  } else {\n    return (\n      <div className=\"MediaGadget\">\n        <FileUploaderDropContainer labelText=\"Drop your media file here\" />\n      </div>\n    );\n  }\n}\n\nconst stateToProps = (state) => {\n  return {\n    uid: state.firebase.auth.uid,\n  };\n};\n\nconst dispatchToProps = (dispatch) => {\n  return {\n    createVariant: (elm) => dispatch(CreateVariant(elm)),\n    deleteVariant: (id) => dispatch(DeleteVariant(id)),\n    deleteAll: () => dispatch(DeleteAll()),\n    setActiveVariant: (id) => dispatch(SetActiveVariant(id)),\n    setMediaPath: (path) => dispatch(SetMediaPath(path)),\n    setMediaType: (type) => dispatch(SetMediaType(type)),\n  };\n};\n\nexport default connect(stateToProps, dispatchToProps)(MediaGadget);\n"]},"metadata":{},"sourceType":"module"}